{"version":3,"file":"index.umd.js","names":["Quill","Quill","quill"],"sources":["../src/utils/bem.ts","../src/utils/components/menu.ts","../src/utils/is.ts","../src/utils/constants.ts","../src/utils/function.ts","../src/utils/searchIndex.ts","../src/index.ts"],"sourcesContent":["export function createBEM(n: string, b: string) {\n  const prefix = n ? `${n}-` : '';\n  return {\n    /** n-b */\n    b: () => `${prefix}${b}`,\n    /** n-b__e */\n    be: (e?: string) => e ? `${prefix}${b}__${e}` : '',\n    /** n-b--m */\n    bm: (m?: string) => m ? `${prefix}${b}--${m}` : '',\n    /** n-b__e--m */\n    bem: (e?: string, m?: string) => e && m ? `${prefix}${b}__${e}--${m}` : '',\n    /** n-s */\n    ns: (s?: string) => s ? `${prefix}${s}` : '',\n    /** n-b-s */\n    bs: (s?: string) => s ? `${prefix}${b}-${s}` : '',\n    /** --n-v */\n    cv: (v?: string) => v ? `--${prefix}${v}` : '',\n    /** is-n */\n    is: (n: string) => `is-${n}`,\n  };\n}\n","import type { MenuItemData } from '../types';\nimport { createBEM } from '../bem';\n\nconst arrow = `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m9 18 6-6-6-6\"></path></svg>`;\nconst bem = createBEM('qsf', 'menu');\nexport function createMenu(data: MenuItemData[]) {\n  const wrapper = document.createElement('div');\n  wrapper.classList.add(bem.b());\n\n  for (const [index, item] of data.entries()) {\n    const { type, classes = [] } = item;\n    const itemWrapper = document.createElement('div');\n    itemWrapper.classList.add(bem.be('item'), ...classes);\n\n    if (type === 'break') {\n      itemWrapper.classList.add(bem.is('break'));\n    }\n    else if (type === 'item') {\n      const { icon, text, content, children = [], onHover, onClick, onClose, onOpen } = item;\n      if (!icon && !text && !content) continue;\n      const eventArg = {\n        data: item,\n        index,\n        item: itemWrapper,\n      };\n      if (content) {\n        itemWrapper.appendChild(content());\n      }\n      else {\n        if (icon) {\n          const iconEl = document.createElement('span');\n          iconEl.classList.add(bem.be('icon'));\n          iconEl.innerHTML = icon;\n          itemWrapper.appendChild(iconEl);\n        }\n        if (text) {\n          const textEl = document.createElement('span');\n          textEl.textContent = text;\n          itemWrapper.appendChild(textEl);\n        }\n      }\n      if (children.length > 0) {\n        itemWrapper.dataset.hasChildren = 'true';\n        const arrowEl = document.createElement('span');\n        arrowEl.classList.add(bem.be('icon'), bem.is('arrow'));\n        arrowEl.innerHTML = arrow;\n        itemWrapper.appendChild(arrowEl);\n\n        const subMenu = createMenu(children);\n        subMenu.classList.add(bem.is('transparent'));\n        let timer: ReturnType<typeof setTimeout> | undefined;\n        const removeSubMenu = () => {\n          subMenu.remove();\n          onClose?.(eventArg);\n        };\n        const showSubMenu = () => {\n          if (itemWrapper.contains(subMenu)) return;\n          if (timer) {\n            clearTimeout(timer);\n            timer = undefined;\n          }\n          itemWrapper.classList.add(bem.is('active'));\n          subMenu.dataset.parent = index.toString();\n          subMenu.removeEventListener('transitionend', removeSubMenu);\n          const rect = itemWrapper.getBoundingClientRect();\n          Object.assign(subMenu.style, {\n            position: 'fixed',\n            top: `${rect.top}px`,\n            left: `${rect.right}px`,\n          });\n          itemWrapper.appendChild(subMenu);\n          requestAnimationFrame(() => {\n            subMenu.classList.remove(bem.is('transparent'));\n            const subRect = subMenu.getBoundingClientRect();\n            if (subRect.right > window.innerWidth) {\n              Object.assign(subMenu.style, {\n                left: `${rect.left - subRect.width}px`,\n              });\n            }\n            if (subRect.bottom > window.innerHeight) {\n              Object.assign(subMenu.style, {\n                top: `${rect.bottom - subRect.height}px`,\n              });\n            }\n            onOpen?.(eventArg);\n          });\n        };\n        const closeSubMenu = () => {\n          if (timer) {\n            clearTimeout(timer);\n            timer = undefined;\n          }\n          timer = setTimeout(() => {\n            subMenu.addEventListener('transitionend', removeSubMenu, { once: true });\n            subMenu.classList.add(bem.is('transparent'));\n          }, 150);\n        };\n\n        itemWrapper.addEventListener('click', showSubMenu);\n        itemWrapper.addEventListener('mouseenter', showSubMenu);\n        itemWrapper.addEventListener('mouseleave', closeSubMenu);\n      }\n\n      if (onHover) {\n        itemWrapper.addEventListener('mouseenter', () => onHover(eventArg));\n      }\n      if (onClick) {\n        itemWrapper.addEventListener('click', () => onClick(eventArg));\n      }\n    }\n    else {\n      continue;\n    }\n\n    wrapper.appendChild(itemWrapper);\n  }\n  return wrapper;\n}\n","export const isUndefined = (val: unknown): val is undefined => val === undefined;\nexport const isString = (val: unknown): val is string => typeof val === 'string';\n","/* eslint-disable no-alert */\nimport type { Range } from 'quill';\nimport type { Context } from 'quill/modules/keyboard';\nimport type { Menu, MenuEventData, MenuItemsGroup, QuillShortcutKeyOptions } from './types';\nimport Quill from 'quill';\nimport { isUndefined } from './is';\n\nconst icons = Quill.import('ui/icons') as Record<string, any>;\nicons.header['1'] = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path class=\"ql-stroke\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 12h8m-8 6V6m8 12V6m5 6l3-2v8\"/></svg>`;\nicons.header['2'] = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path class=\"ql-stroke\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 12h8m-8 6V6m8 12V6m9 12h-4c0-4 4-3 4-6c0-1.5-2-2.5-4-1\"/></svg>`;\nicons.header['3'] = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path class=\"ql-stroke\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 12h8m-8 6V6m8 12V6m5.5 4.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2m-2 3.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2\"/></svg>`;\nicons.header['4'] = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path class=\"ql-stroke\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 18V6m5 4v3a1 1 0 0 0 1 1h3m0-4v8M4 12h8m-8 6V6\"/></svg>`;\nicons.header['5'] = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path class=\"ql-stroke\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 12h8m-8 6V6m8 12V6m5 7v-3h4m-4 7.7c.4.2.8.3 1.3.3c1.5 0 2.7-1.1 2.7-2.5S19.8 13 18.3 13H17\"/></svg>`;\nicons.header['6'] = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"ql-stroke\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"><path d=\"M4 12h8m-8 6V6m8 12V6\"/><circle cx=\"19\" cy=\"16\" r=\"2\"/><path d=\"M20 10c-2 2-3 3.5-3 6\"/></g></svg>`;\n\nconst title = {\n  h1: '标题1',\n  h2: '标题2',\n  h3: '标题3',\n  h4: '标题4',\n  h5: '标题5',\n  h6: '标题6',\n  blockquote: '引用',\n  codeblock: '代码块',\n  code: '行内代码',\n  link: '链接',\n  image: '图片',\n  video: '视频',\n  formula: '公式',\n  list: '列表',\n  listBullet: '无序列表',\n  listOrdered: '有序列表',\n  listCheck: '任务列表',\n};\nconst descriptions = {\n  blockquote: '插入引用格式',\n};\n\nexport const defaultMenuItems: Menu = [\n  ...new Array(6).fill(0).map((_, i) => ({\n    type: 'item' as const,\n    name: `h${i + 1}`,\n    alias: ['header', `head${i + 1}`],\n    icon: icons.header[i + 1],\n    title: title[`h${i + 1}` as 'h1'],\n    onClick(this: Quill, range: Range | null, _: any) {\n      if (!range) return;\n      this.formatLine(range.index, 0, 'header', i + 1, Quill.sources.USER);\n    },\n  })),\n  {\n    type: 'item' as const,\n    name: 'bq',\n    alias: ['blockquote'],\n    icon: icons.blockquote,\n    title: title.blockquote,\n    descriptions: descriptions.blockquote,\n    onClick(this: Quill, range: Range | null, _: any) {\n      if (!range) return;\n      this.formatLine(range.index, 0, 'blockquote', true, Quill.sources.USER);\n    },\n  },\n  {\n    type: 'item' as const,\n    name: 'cb',\n    alias: ['code', 'codeblock'],\n    icon: icons['code-block'],\n    title: title.codeblock,\n    onClick(this: Quill, range: Range | null, _: any) {\n      if (!range) return;\n      this.formatLine(range.index, 0, 'code-block', true, Quill.sources.USER);\n    },\n  },\n  {\n    type: 'item' as const,\n    name: 'lk',\n    alias: ['link'],\n    icon: icons.link,\n    title: title.link,\n    onClick(this: Quill, range: Range | null, _: any) {\n      if (!range) return;\n      const title = prompt('Enter link title');\n      if (!title) return;\n      const link = prompt('Enter link URL');\n      if (!link) return;\n      this.insertText(range.index, title, Quill.sources.USER);\n      this.formatText(range.index, range.length + title.length, 'link', link, Quill.sources.USER);\n      this.setSelection({ index: range.index, length: range.index + title.length });\n    },\n  },\n  {\n    type: 'item' as const,\n    name: 'img',\n    alias: ['image', 'pic', 'picture'],\n    icon: icons.image,\n    title: title.image,\n    onClick(this: Quill, range: Range | null, _: any) {\n      if (!range) return;\n      const src = prompt('Enter image');\n      if (!src) return;\n      this.insertEmbed(range.index, 'image', src, Quill.sources.USER);\n    },\n  },\n  {\n    type: 'item' as const,\n    name: 'vd',\n    alias: ['video'],\n    icon: icons.video,\n    title: title.video,\n    onClick(this: Quill, range: Range | null, _: any) {\n      if (!range) return;\n      const src = prompt('Enter video');\n      if (!src) return;\n      this.insertEmbed(range.index, 'video', src, Quill.sources.USER);\n    },\n  },\n  {\n    type: 'item' as const,\n    name: 'fm',\n    alias: ['formula'],\n    icon: icons.formula,\n    title: title.formula,\n    onClick(this: Quill, range: Range | null, _: any) {\n      if (!range) return;\n      const text = prompt('Enter formula');\n      if (!text) return;\n      this.insertEmbed(range.index, 'formula', text, Quill.sources.USER);\n    },\n  },\n  {\n    type: 'group' as const,\n    name: 'list',\n    alias: [],\n    hideSearch: true,\n    icon: icons.list.bullet,\n    title: title.list,\n    children: [\n      {\n        type: 'item' as const,\n        name: 'bl',\n        alias: ['list', 'bullet'],\n        icon: icons.list.bullet,\n        title: title.listBullet,\n        onClick(this: Quill, range: Range | null, _: any) {\n          if (!range) return;\n          this.formatLine(range.index, 0, 'list', 'bullet', Quill.sources.USER);\n        },\n      },\n      {\n        type: 'item' as const,\n        name: 'od',\n        alias: ['list', 'ordered'],\n        icon: icons.list.ordered,\n        title: title.listOrdered,\n        onClick(this: Quill, range: Range | null, _: any) {\n          if (!range) return;\n          this.formatLine(range.index, 0, 'list', 'ordered', Quill.sources.USER);\n        },\n      },\n      {\n        type: 'item' as const,\n        name: 'ck',\n        alias: ['list', 'check'],\n        icon: icons.list.check,\n        title: title.listCheck,\n        onClick(this: Quill, range: Range | null, _: any) {\n          if (!range) return;\n          this.formatLine(range.index, 0, 'list', 'unchecked', Quill.sources.USER);\n        },\n      },\n    ],\n  },\n];\n\nfunction generateShortKey(formatWithKeyMap: Record<string, Record<string, any>>) {\n  const formatAndValue = Object.keys(formatWithKeyMap);\n  const bindings: Record<string, any> = {};\n  for (const item of formatAndValue) {\n    const [format, value] = item.split(' ');\n    const isSwitch = isUndefined(value);\n    bindings[item] = {\n      handler(this: { quill: Quill }, range: Range, context: Context) {\n        this.quill.format(format, isSwitch ? !context.format[format] : value, Quill.sources.USER);\n      },\n      ...formatWithKeyMap[item],\n    };\n  }\n  return bindings;\n}\nexport const defaultShortKey = {\n  clean: {\n    key: '/',\n    shortKey: true,\n    handler(this: { quill: Quill }, range: Range) {\n      this.quill.removeFormat(range.index, range.length, Quill.sources.USER);\n    },\n  },\n  ...generateShortKey({\n    'strike': {\n      key: 'd',\n      shortKey: true,\n    },\n    'align ': {\n      key: 'l',\n      altKey: true,\n    },\n    'align center': {\n      key: 'c',\n      altKey: true,\n    },\n    'align right': {\n      key: 'r',\n      altKey: true,\n    },\n    'align justify': {\n      key: 'j',\n      altKey: true,\n    },\n    'indent +1': {\n      key: ']',\n      shortKey: true,\n    },\n    'indent -1': {\n      key: '[',\n      shortKey: true,\n    },\n    'script sub': {\n      key: ';',\n      shortKey: true,\n    },\n    'script super': {\n      key: '\\'',\n      shortKey: true,\n    },\n    'code': {\n      key: 'e',\n      shortKey: true,\n    },\n    'direction rtl': {\n      key: 'r',\n      shortKey: true,\n    },\n    'direction ': {\n      key: 'l',\n      shortKey: true,\n    },\n  }),\n};\n\nexport function generateTableUpShortKeyMenu(createSelectBox: (ops: { row: number; col: number; customBtn: boolean }) => HTMLElement): {\n  tableUpKeyboardControl: QuillShortcutKeyOptions['menuKeyboardControls'];\n  tableUpConfig: MenuItemsGroup;\n} {\n  const maxSelectRow = 8;\n  const maxSelectCol = 8;\n  const selectBox = createSelectBox({\n    row: maxSelectRow,\n    col: maxSelectCol,\n    customBtn: false,\n  });\n  const updateSelectActiveItems = () => {\n    const { row, col } = selectBox.dataset;\n    for (const item of Array.from(selectBox.querySelectorAll('.active'))) {\n      item.classList.remove('active');\n    }\n    if (!row || !col) return;\n    const childs = Array.from(selectBox.querySelectorAll('.table-up-select-box__item')) as HTMLElement[];\n    for (const item of childs) {\n      const { row: childRow, col: childCol } = item.dataset;\n      if (childRow! > row && childCol! > col) {\n        return;\n      }\n      item.classList.toggle('active', childRow! <= row && childCol! <= col);\n    }\n  };\n\n  return {\n    tableUpKeyboardControl: (event: KeyboardEvent, { currentMenu }: { currentMenu: HTMLElement; selectedIndex: number }) => {\n      if (!currentMenu.contains(selectBox)) return false;\n      let row = Number(selectBox.dataset.row);\n      let col = Number(selectBox.dataset.col);\n      switch (event.key) {\n        case 'ArrowUp': {\n          row -= 1;\n          break;\n        }\n        case 'ArrowDown': {\n          row += 1;\n          break;\n        }\n        case 'ArrowRight': {\n          col += 1;\n          break;\n        }\n        case 'ArrowLeft': {\n          col -= 1;\n          break;\n        }\n        default: {\n          return false;\n        }\n      }\n      if (row <= 0 || col <= 0) return false;\n      row = Math.min(row, 8);\n      col = Math.min(col, 8);\n      selectBox.dataset.row = String(row);\n      selectBox.dataset.col = String(col);\n      updateSelectActiveItems();\n      event.preventDefault();\n      return true;\n    },\n    tableUpConfig: {\n      type: 'group',\n      name: 'table',\n      alias: [],\n      title: '表格',\n      icon: (Quill.import('ui/icons') as Record<string, string>).table,\n      onOpenSub(data: MenuEventData) {\n        const subMenu = data.item.querySelector('.qsf-menu') as HTMLElement;\n        if (subMenu) {\n          subMenu.style.width = 'auto';\n        }\n        selectBox.dataset.row = '1';\n        selectBox.dataset.col = '1';\n        updateSelectActiveItems();\n      },\n      children: [\n        {\n          type: 'item',\n          name: 'table',\n          alias: [],\n          classes: ['no-selected-style'],\n          hideSearch: true,\n          content() {\n            return selectBox;\n          },\n          onClick(this: Quill) {\n            const { row, col } = selectBox.dataset;\n            if (!row || !col) return;\n            const tableUp = this.getModule('table-up') as any;\n            tableUp.insertTable(Number(row), Number(col));\n          },\n        },\n      ],\n    },\n  };\n}\n","export function throttle(func: (...args: any[]) => any, wait: number) {\n  let timeout: ReturnType<typeof setTimeout> | null = null;\n  let lastCallTime = 0;\n\n  return function (this: any, ...args: any[]) {\n    const now = Date.now();\n    const remainingTime = wait - (now - lastCallTime);\n\n    if (remainingTime <= 0 || remainingTime > wait) {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n      lastCallTime = now;\n      func.apply(this, args);\n    }\n    else if (!timeout) {\n      const boundFunc = func.bind(this, ...args);\n      timeout = setTimeout(() => {\n        lastCallTime = Date.now();\n        timeout = null;\n        boundFunc();\n      }, remainingTime);\n    }\n  };\n}\n","import type { SearchIndexInput } from './types';\n\nfunction matchScore(input: string, target: string): number {\n  const inputLower = input.toLowerCase();\n  const targetLower = target.toLowerCase();\n\n  if (inputLower === targetLower) {\n    return 2; // 完全匹配\n  }\n  else if (targetLower.includes(inputLower)) {\n    return 1; // 部分匹配\n  }\n  else {\n    return 0; // 不匹配\n  }\n}\n\nexport function searchAndSort<T extends SearchIndexInput[]>(items: T, input: string): T {\n  const threshold = 0.5; // 匹配分数阈值\n\n  const scoredItems = items.map((item) => {\n    let score = matchScore(input, item.name);\n\n    if (item.alias) {\n      for (const alias of item.alias) {\n        score = Math.max(score, matchScore(input, alias));\n      }\n    }\n\n    return { item, score };\n  });\n\n  const filteredItems = scoredItems.filter(({ score }) => score >= threshold);\n  filteredItems.sort((a, b) => b.score - a.score);\n  return filteredItems.map(({ item }) => item) as T;\n}\n","import type { Delta, Range } from 'quill';\nimport type { BlockEmbed as TypeBlockEmbed } from 'quill/blots/block';\nimport type TypeBlock from 'quill/blots/block';\nimport type { Menu, MenuItemData, MenuItems, MenuItemsGroup, QuillShortcutKeyInputOptions, QuillShortcutKeyOptions } from './utils';\nimport Quill from 'quill';\nimport { createBEM, createMenu, isString, searchAndSort, throttle } from './utils';\n\nconst Parchment = Quill.import('parchment');\n\nexport class QuillShortcutKey {\n  bem = createBEM('qsf', 'menu');\n  options: QuillShortcutKeyOptions;\n  menuSorter: (searchText: string) => Menu;\n  currentMenu: Menu;\n  menuContainer?: HTMLElement;\n  menuKeyboardControlsCleanup?: () => void;\n  currentRange: Range = { index: 0, length: 0 };\n  placeholderBem = createBEM('qsf', 'placeholder');\n  placeholderTip: HTMLElement;\n\n  constructor(public quill: Quill, options: Partial<QuillShortcutKeyInputOptions>) {\n    this.options = this.resolveOptions(options);\n    this.currentMenu = this.options.menuItems;\n    this.menuSorter = searchAndSort.bind(this, this.getAllMenuItems()) as (searchText: string) => Menu;\n\n    this.placeholderTip = this.initPlaceholder();\n    this.placeholderUpdate();\n    this.quill.on(Quill.events.COMPOSITION_START, () => {\n      this.placeholderHide();\n    });\n    this.quill.on(Quill.events.COMPOSITION_END, () => {\n      this.placeholderUpdate();\n    });\n    this.quill.on(Quill.events.EDITOR_CHANGE, (type: string, current: Delta | Range) => {\n      this.placeholderUpdate();\n\n      if (type === Quill.events.SELECTION_CHANGE) {\n        const range = current as Range;\n        if (range && range.length === 0) {\n          const [line, offset] = this.quill.getLine(range.index);\n          if (line) {\n            const lineStartIndex = range.index - offset;\n            const lineEndIndex = lineStartIndex + line.length();\n            const text = this.quill.getText(lineStartIndex, lineEndIndex);\n            const formats = this.quill.getFormat(range.index, range.length);\n            const hasBlock = this.hasBlockFormat(formats);\n            if (text.startsWith('/') && !hasBlock) {\n              const matchString = text.match(/^\\/(.+)/);\n              if (matchString) {\n                const matchItems = this.menuSorter(matchString[1]);\n                this.currentMenu = matchItems;\n              }\n              else {\n                this.currentMenu = this.options.menuItems;\n              }\n              this.updateMenuList(line, formats);\n              return;\n            }\n          }\n        }\n        this.destroyMenuList();\n      }\n      else if (type === Quill.events.TEXT_CHANGE) {\n        const delta = current as Delta;\n        for (const op of delta.ops) {\n          if (op.insert) {\n            if (op.insert === '/') {\n              this.generateMenuList();\n            }\n            else {\n              break;\n            }\n          }\n        }\n      }\n    });\n    this.quill.root.addEventListener('scroll', () => {\n      this.placeholderUpdate();\n    });\n  }\n\n  resolveOptions(options: Partial<QuillShortcutKeyInputOptions>): QuillShortcutKeyOptions {\n    return Object.assign({\n      placeholder: 'Input / recall menu',\n      menuItems: [] as any[],\n      menuKeyboardControls: () => false,\n    }, options);\n  }\n\n  getAllMenuItems() {\n    const list: Menu = [];\n    for (const item of this.options.menuItems) {\n      if (!item.hideSearch) {\n        list.push(item);\n      }\n      if (item.type === 'group') {\n        list.push(...item.children.filter(i => !i.hideSearch));\n      }\n    }\n    return list;\n  }\n\n  hasBlockFormat(formats: Record<string, any>): boolean {\n    return Object.keys(formats).some(format => this.quill.scroll.registry.query(format, Parchment.Scope.BLOCK_BLOT));\n  }\n\n  initPlaceholder() {\n    const wrapper = this.quill.addContainer(this.placeholderBem.be('wrapper'));\n    const tip = this.quill.addContainer(this.placeholderBem.b());\n    tip.dataset.placeholder = this.options.placeholder;\n    wrapper.appendChild(tip);\n    return tip;\n  }\n\n  placeholderUpdate() {\n    const range = this.quill.getSelection();\n    if (range) {\n      this.currentRange = range;\n    }\n    // if use attribute mark on current focus line. will have selection wrong behavior when use keyboard `Shift` and `ArrowUp` select editor\n    if (this.currentRange.length === 0) {\n      const [line] = this.quill.getLine(this.currentRange.index);\n\n      if (line && line.length() <= 1) {\n        const delta = this.quill.getContents(this.currentRange.index, line.length() || 0).ops[0];\n        const hasBlockFormat = this.hasBlockFormat(delta.attributes || {});\n        let hasBlockEmbed = false;\n        if (!isString(delta.insert)) {\n          hasBlockEmbed = this.hasBlockFormat(delta.insert || {});\n        }\n        if (!hasBlockFormat && !hasBlockEmbed) {\n          const bound = this.quill.getBounds(this.currentRange);\n          if (bound) {\n            this.placeholderTip.classList.remove(\n              this.placeholderBem.is('hidden'),\n              this.placeholderBem.is('right'),\n            );\n            const style = {\n              left: `${bound.left}px`,\n              top: `${bound.top}px`,\n            };\n            if (delta.attributes && delta.attributes.align === 'right') {\n              this.placeholderTip.classList.add(this.placeholderBem.is('right'));\n              // minus for placeholder position looks more natural\n              style.left = `${bound.right - 1}px`;\n            }\n            Object.assign(this.placeholderTip.style, style);\n          }\n          return;\n        }\n      }\n    }\n    this.placeholderHide();\n  }\n\n  placeholderHide() {\n    this.placeholderTip.classList.add(this.placeholderBem.is('hidden'));\n  }\n\n  generateMenuItem(relativeLine: TypeBlock | TypeBlockEmbed, item: MenuItems | MenuItemsGroup): MenuItemData {\n    return {\n      ...item,\n      type: 'item' as const,\n      children: ((item as MenuItemsGroup).children || []).map(i => this.generateMenuItem(relativeLine, i)),\n      content: () => {\n        if (item.content) {\n          return item.content();\n        }\n        else {\n          const itemContent = document.createElement('div');\n          itemContent.classList.add(this.bem.be('item-container'));\n\n          if (item.icon) {\n            const iconWrap = document.createElement('div');\n            iconWrap.classList.add(this.bem.be('item-icon'));\n            const icon = document.createElement('div');\n            icon.classList.add(this.bem.be('icon'));\n            icon.innerHTML = item.icon;\n            iconWrap.appendChild(icon);\n            itemContent.appendChild(iconWrap);\n          }\n\n          const itemContentMain = document.createElement('div');\n          itemContentMain.classList.add(this.bem.be('item-content'));\n\n          const itemContentTitle = document.createElement('div');\n          itemContentTitle.classList.add(this.bem.be('item-title'));\n          const titleText = document.createElement('span');\n          titleText.textContent = item.title!;\n          itemContentTitle.appendChild(titleText);\n\n          if (item.type === 'item') {\n            const itemContentHint = document.createElement('span');\n            itemContentHint.classList.add(this.bem.be('item-hint'));\n            itemContentHint.textContent = `/${item.name}`;\n            itemContentTitle.appendChild(itemContentHint);\n          }\n          itemContentMain.appendChild(itemContentTitle);\n\n          if (item.descriptions) {\n            const itemContentDescriptions = document.createElement('div');\n            itemContentDescriptions.classList.add(this.bem.be('item-descriptions'));\n            itemContentDescriptions.textContent = item.descriptions;\n            itemContentMain.appendChild(itemContentDescriptions);\n          }\n\n          itemContent.appendChild(itemContentMain);\n          return itemContent;\n        }\n      },\n      onClose: (data) => {\n        if (item.onCloseSub) {\n          item.onCloseSub.call(this.quill, data);\n        }\n      },\n      onOpen: (data) => {\n        if (item.onOpenSub) {\n          item.onOpenSub.call(this.quill, data);\n        }\n      },\n      onClick: (data) => {\n        if (item.type === 'item') {\n          relativeLine.domNode.innerHTML = '';\n          this.destroyMenuList();\n        }\n        if (item.onClick) {\n          const range = this.quill.getSelection();\n          item.onClick.call(this.quill, range, data);\n        }\n      },\n    };\n  }\n\n  generateMenuList() {\n    if (!this.menuContainer) {\n      this.menuContainer = document.createElement('div');\n      this.menuContainer.classList.add(this.bem.be('container'));\n      this.quill.root.addEventListener('click', this.destroyMenuList);\n      this.quill.container.appendChild(this.menuContainer);\n    }\n  }\n\n  updateMenuList(relativeLine: TypeBlock | TypeBlockEmbed, formats: Record<string, any>) {\n    if (!this.menuContainer) return;\n\n    this.menuContainer.innerHTML = '';\n    const content = createMenu(this.currentMenu.map(item => this.generateMenuItem(relativeLine, item)));\n    if (this.menuKeyboardControlsCleanup) {\n      this.menuKeyboardControlsCleanup();\n    }\n    this.menuKeyboardControlsCleanup = this.setupMenuKeyboardControls({\n      wrapper: content,\n      target: this.quill.root,\n      menuControl: this.options.menuKeyboardControls,\n    });\n    const rootRect = this.quill.root.getBoundingClientRect();\n    const lineRect = relativeLine.domNode.getBoundingClientRect();\n    const left = lineRect.left - rootRect.left + (formats.align === 'right' ? lineRect.width : 0);\n    const top = lineRect.bottom - rootRect.top;\n    Object.assign(this.menuContainer.style, {\n      left: `${left}px`,\n      top: `${top}px`,\n    });\n    this.menuContainer.appendChild(content);\n    // limit in viewport\n    requestAnimationFrame(() => {\n      if (!this.menuContainer) return;\n      const rect = this.menuContainer.getBoundingClientRect();\n      if (window.innerWidth < rect.right) {\n        this.menuContainer.style.left = `${left - rect.width}px`;\n      }\n      if (window.innerHeight < rect.bottom) {\n        this.menuContainer.style.top = `${top - lineRect.height - rect.height}px`;\n      }\n    });\n  }\n\n  destroyMenuList = () => {\n    this.quill.root.removeEventListener('click', this.destroyMenuList);\n    if (this.menuKeyboardControlsCleanup) this.menuKeyboardControlsCleanup();\n    if (!this.menuContainer) return;\n    this.menuContainer.remove();\n    this.menuContainer = undefined;\n  };\n\n  setupMenuKeyboardControls({ wrapper, target, menuControl }: {\n    wrapper: HTMLElement;\n    target: HTMLElement;\n    menuControl: (event: KeyboardEvent, data: { currentMenu: HTMLElement; selectedIndex: number }) => boolean;\n  }) {\n    let currentMenu = wrapper;\n    let parentMenu: HTMLElement | null = null;\n    let selectedIndex = -1;\n\n    const setSelected = (index: number) => {\n      const items = Array.from(currentMenu.querySelectorAll(`.${this.bem.be('item')}`)) as HTMLElement[];\n      for (const [i, item] of items.entries()) {\n        if (i === index) {\n          item.classList.add(this.bem.is('selected'));\n\n          const containerRect = currentMenu.getBoundingClientRect();\n          const itemRect = item.getBoundingClientRect();\n\n          const isItemBelow = itemRect.bottom > containerRect.bottom;\n          const isItemAbove = itemRect.top < containerRect.top;\n          if (isItemBelow) {\n            currentMenu.scrollTop = item.offsetTop - currentMenu.clientHeight + itemRect.height;\n          }\n          else if (isItemAbove) {\n            currentMenu.scrollTop = item.offsetTop;\n          }\n        }\n        else {\n          item.classList.remove(this.bem.is('selected'));\n        }\n      }\n      selectedIndex = index;\n    };\n\n    const handleItemSelect = throttle((event: KeyboardEvent) => {\n      const items = currentMenu.querySelectorAll(`:scope > .${this.bem.be('item')}`);\n      if ((items.length === 0 && event.key === 'Enter') || event.key === 'Escape') {\n        event.preventDefault();\n        this.destroyMenuList();\n      }\n      if (items.length === 0) {\n        return;\n      }\n\n      const prevent = menuControl(event, { currentMenu, selectedIndex });\n      if (prevent) return;\n\n      switch (event.key) {\n        case 'ArrowUp': {\n          event.preventDefault();\n          if (selectedIndex === -1) selectedIndex = 0;\n          setSelected((selectedIndex - 1 + items.length) % items.length);\n          break;\n        }\n        case 'ArrowDown': {\n          event.preventDefault();\n          setSelected((selectedIndex + 1) % items.length);\n          break;\n        }\n        case 'ArrowRight': {\n          event.preventDefault();\n          const selectedItem = items[selectedIndex] as HTMLElement;\n          if (!selectedItem) return;\n          const hasSubMenu = selectedItem.dataset.hasChildren === 'true';\n          if (hasSubMenu) {\n            selectedItem.click();\n            const subMenu = selectedItem.querySelector(`.${this.bem.b()}`) as HTMLElement;\n            if (subMenu) {\n              parentMenu = currentMenu;\n              currentMenu = subMenu;\n              setSelected(0);\n            }\n          }\n          break;\n        }\n        case 'ArrowLeft': {\n          event.preventDefault();\n          if (parentMenu) {\n            const parentIndex = Number.parseInt(currentMenu.dataset.parent || '0', 10);\n            currentMenu = parentMenu;\n            parentMenu = null;\n            selectedIndex = parentIndex;\n            setSelected(selectedIndex);\n            const selectedItem = Array.from(currentMenu.querySelectorAll(`.${this.bem.be('item')}`))[selectedIndex] as HTMLElement;\n            if (!selectedItem) return;\n            selectedItem.dispatchEvent(new MouseEvent('mouseleave'));\n          }\n          break;\n        }\n        case 'Enter': {\n          event.preventDefault();\n          // default select first\n          const selectedItem = items[Math.max(0, selectedIndex)] as HTMLElement;\n          if (selectedItem) {\n            selectedItem.click();\n            if (selectedItem.dataset.hasChildren === 'true') {\n              const subMenu = selectedItem.querySelector(`.${this.bem.b()}`) as HTMLElement;\n              if (subMenu) {\n                parentMenu = currentMenu;\n                currentMenu = subMenu;\n                setSelected(0);\n              }\n            }\n          }\n          break;\n        }\n      }\n    }, 100);\n    const handleKeyDown = (event: KeyboardEvent) => {\n      const keys = new Set([\n        'ArrowUp',\n        'ArrowDown',\n        'ArrowRight',\n        'ArrowLeft',\n        'Enter',\n        'Escape',\n      ]);\n      if (keys.has(event.key)) {\n        event.preventDefault();\n      }\n      handleItemSelect(event);\n    };\n\n    target.addEventListener('keydown', handleKeyDown, true);\n    return () => {\n      target.removeEventListener('keydown', handleKeyDown, true);\n    };\n  }\n}\n\nexport { defaultMenuItems, defaultShortKey, generateTableUpShortKeyMenu, searchAndSort } from './utils';\nexport default QuillShortcutKey;\nexport * from './utils/types';\n"],"mappings":"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"}