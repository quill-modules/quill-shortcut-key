{"version":3,"file":"index.umd.js","names":["Quill","Quill","quill"],"sources":["../src/utils/bem.ts","../src/utils/components/menu.ts","../src/utils/is.ts","../src/utils/constants.ts","../src/utils/function.ts","../src/utils/searchIndex.ts","../src/index.ts"],"sourcesContent":["export const createBEM = (n: string, b: string) => {\r\n  const prefix = n ? `${n}-` : '';\r\n  return {\r\n    /** n-b */\r\n    b: () => `${prefix}${b}`,\r\n    /** n-b__e */\r\n    be: (e?: string) => e ? `${prefix}${b}__${e}` : '',\r\n    /** n-b--m */\r\n    bm: (m?: string) => m ? `${prefix}${b}--${m}` : '',\r\n    /** n-b__e--m */\r\n    bem: (e?: string, m?: string) => e && m ? `${prefix}${b}__${e}--${m}` : '',\r\n    /** n-s */\r\n    ns: (s?: string) => s ? `${prefix}${s}` : '',\r\n    /** n-b-s */\r\n    bs: (s?: string) => s ? `${prefix}${b}-${s}` : '',\r\n    /** --n-v */\r\n    cv: (v?: string) => v ? `--${prefix}${v}` : '',\r\n    /** is-n */\r\n    is: (n: string) => `is-${n}`,\r\n  };\r\n};\r\n","import type { MenuItemData } from '../types';\r\nimport { createBEM } from '../bem';\r\n\r\nconst arrow = `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m9 18 6-6-6-6\"></path></svg>`;\r\nconst bem = createBEM('qsf', 'menu');\r\nexport const createMenu = (data: MenuItemData[]) => {\r\n  const wrapper = document.createElement('div');\r\n  wrapper.classList.add(bem.b());\r\n\r\n  for (const [index, item] of data.entries()) {\r\n    const { type, classes = [] } = item;\r\n    const itemWrapper = document.createElement('div');\r\n    itemWrapper.classList.add(bem.be('item'), ...classes);\r\n\r\n    if (type === 'break') {\r\n      itemWrapper.classList.add(bem.is('break'));\r\n    }\r\n    else if (type === 'item') {\r\n      const { icon, text, content, children = [], onHover, onClick, onClose, onOpen } = item;\r\n      if (!icon && !text && !content) continue;\r\n      const eventArg = {\r\n        data: item,\r\n        index,\r\n        item: itemWrapper,\r\n      };\r\n      if (content) {\r\n        itemWrapper.appendChild(content());\r\n      }\r\n      else {\r\n        if (icon) {\r\n          const iconEl = document.createElement('span');\r\n          iconEl.classList.add(bem.be('icon'));\r\n          iconEl.innerHTML = icon;\r\n          itemWrapper.appendChild(iconEl);\r\n        }\r\n        if (text) {\r\n          const textEl = document.createElement('span');\r\n          textEl.textContent = text;\r\n          itemWrapper.appendChild(textEl);\r\n        }\r\n      }\r\n      if (children.length > 0) {\r\n        itemWrapper.dataset.hasChildren = 'true';\r\n        const arrowEl = document.createElement('span');\r\n        arrowEl.classList.add(bem.be('icon'), bem.is('arrow'));\r\n        arrowEl.innerHTML = arrow;\r\n        itemWrapper.appendChild(arrowEl);\r\n\r\n        const subMenu = createMenu(children);\r\n        subMenu.classList.add(bem.is('transparent'));\r\n        let timer: ReturnType<typeof setTimeout> | undefined;\r\n        const removeSubMenu = () => {\r\n          subMenu.remove();\r\n          onClose?.(eventArg);\r\n        };\r\n        const showSubMenu = () => {\r\n          if (itemWrapper.contains(subMenu)) return;\r\n          if (timer) {\r\n            clearTimeout(timer);\r\n            timer = undefined;\r\n          }\r\n          itemWrapper.classList.add(bem.is('active'));\r\n          subMenu.dataset.parent = index.toString();\r\n          subMenu.removeEventListener('transitionend', removeSubMenu);\r\n          const rect = itemWrapper.getBoundingClientRect();\r\n          Object.assign(subMenu.style, {\r\n            position: 'fixed',\r\n            top: `${rect.top}px`,\r\n            left: `${rect.right}px`,\r\n          });\r\n          itemWrapper.appendChild(subMenu);\r\n          requestAnimationFrame(() => {\r\n            subMenu.classList.remove(bem.is('transparent'));\r\n            const subRect = subMenu.getBoundingClientRect();\r\n            if (subRect.right > window.innerWidth) {\r\n              Object.assign(subMenu.style, {\r\n                left: `${rect.left - subRect.width}px`,\r\n              });\r\n            }\r\n            if (subRect.bottom > window.innerHeight) {\r\n              Object.assign(subMenu.style, {\r\n                top: `${rect.bottom - subRect.height}px`,\r\n              });\r\n            }\r\n            onOpen?.(eventArg);\r\n          });\r\n        };\r\n        const closeSubMenu = () => {\r\n          if (timer) {\r\n            clearTimeout(timer);\r\n            timer = undefined;\r\n          }\r\n          timer = setTimeout(() => {\r\n            subMenu.addEventListener('transitionend', removeSubMenu, { once: true });\r\n            subMenu.classList.add(bem.is('transparent'));\r\n          }, 150);\r\n        };\r\n\r\n        itemWrapper.addEventListener('click', showSubMenu);\r\n        itemWrapper.addEventListener('mouseenter', showSubMenu);\r\n        itemWrapper.addEventListener('mouseleave', closeSubMenu);\r\n      }\r\n\r\n      if (onHover) {\r\n        itemWrapper.addEventListener('mouseenter', () => onHover(eventArg));\r\n      }\r\n      if (onClick) {\r\n        itemWrapper.addEventListener('click', () => onClick(eventArg));\r\n      }\r\n    }\r\n    else {\r\n      continue;\r\n    }\r\n\r\n    wrapper.appendChild(itemWrapper);\r\n  }\r\n  return wrapper;\r\n};\r\n","export const isUndefined = (val: unknown): val is undefined => val === undefined;\r\nexport const isString = (val: unknown): val is string => typeof val === 'string';\r\n","/* eslint-disable no-alert */\r\nimport type { Range } from 'quill';\r\nimport type { Context } from 'quill/modules/keyboard';\r\nimport type { Menu, MenuEventData, MenuItemsGroup, QuillShortcutKeyOptions } from './types';\r\nimport Quill from 'quill';\r\nimport { isUndefined } from './is';\r\n\r\nconst icons = Quill.import('ui/icons') as Record<string, any>;\r\nicons.header['1'] = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path class=\"ql-stroke\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 12h8m-8 6V6m8 12V6m5 6l3-2v8\"/></svg>`;\r\nicons.header['2'] = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path class=\"ql-stroke\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 12h8m-8 6V6m8 12V6m9 12h-4c0-4 4-3 4-6c0-1.5-2-2.5-4-1\"/></svg>`;\r\nicons.header['3'] = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path class=\"ql-stroke\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 12h8m-8 6V6m8 12V6m5.5 4.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2m-2 3.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2\"/></svg>`;\r\nicons.header['4'] = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path class=\"ql-stroke\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 18V6m5 4v3a1 1 0 0 0 1 1h3m0-4v8M4 12h8m-8 6V6\"/></svg>`;\r\nicons.header['5'] = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path class=\"ql-stroke\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 12h8m-8 6V6m8 12V6m5 7v-3h4m-4 7.7c.4.2.8.3 1.3.3c1.5 0 2.7-1.1 2.7-2.5S19.8 13 18.3 13H17\"/></svg>`;\r\nicons.header['6'] = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"ql-stroke\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"><path d=\"M4 12h8m-8 6V6m8 12V6\"/><circle cx=\"19\" cy=\"16\" r=\"2\"/><path d=\"M20 10c-2 2-3 3.5-3 6\"/></g></svg>`;\r\n\r\nconst title = {\r\n  h1: '标题1',\r\n  h2: '标题2',\r\n  h3: '标题3',\r\n  h4: '标题4',\r\n  h5: '标题5',\r\n  h6: '标题6',\r\n  blockquote: '引用',\r\n  codeblock: '代码块',\r\n  code: '行内代码',\r\n  link: '链接',\r\n  image: '图片',\r\n  video: '视频',\r\n  formula: '公式',\r\n  list: '列表',\r\n  listBullet: '无序列表',\r\n  listOrdered: '有序列表',\r\n  listCheck: '任务列表',\r\n};\r\nconst descriptions = {\r\n  blockquote: '插入引用格式',\r\n};\r\n\r\nexport const defaultMenuItems: Menu = [\r\n  ...new Array(6).fill(0).map((_, i) => ({\r\n    type: 'item' as const,\r\n    name: `h${i + 1}`,\r\n    alias: ['header', `head${i + 1}`],\r\n    icon: icons.header[i + 1],\r\n    title: title[`h${i + 1}` as 'h1'],\r\n    onClick(this: Quill, range: Range | null, _: any) {\r\n      if (!range) return;\r\n      this.formatLine(range.index, 0, 'header', i + 1, Quill.sources.USER);\r\n    },\r\n  })),\r\n  {\r\n    type: 'item' as const,\r\n    name: 'bq',\r\n    alias: ['blockquote'],\r\n    icon: icons.blockquote,\r\n    title: title.blockquote,\r\n    descriptions: descriptions.blockquote,\r\n    onClick(this: Quill, range: Range | null, _: any) {\r\n      if (!range) return;\r\n      this.formatLine(range.index, 0, 'blockquote', true, Quill.sources.USER);\r\n    },\r\n  },\r\n  {\r\n    type: 'item' as const,\r\n    name: 'cb',\r\n    alias: ['code', 'codeblock'],\r\n    icon: icons['code-block'],\r\n    title: title.codeblock,\r\n    onClick(this: Quill, range: Range | null, _: any) {\r\n      if (!range) return;\r\n      this.formatLine(range.index, 0, 'code-block', true, Quill.sources.USER);\r\n    },\r\n  },\r\n  {\r\n    type: 'item' as const,\r\n    name: 'lk',\r\n    alias: ['link'],\r\n    icon: icons.link,\r\n    title: title.link,\r\n    onClick(this: Quill, range: Range | null, _: any) {\r\n      if (!range) return;\r\n      const title = prompt('Enter link title');\r\n      if (!title) return;\r\n      const link = prompt('Enter link URL');\r\n      if (!link) return;\r\n      this.insertText(range.index, title, Quill.sources.USER);\r\n      this.formatText(range.index, range.length + title.length, 'link', link, Quill.sources.USER);\r\n      this.setSelection({ index: range.index, length: range.index + title.length });\r\n    },\r\n  },\r\n  {\r\n    type: 'item' as const,\r\n    name: 'img',\r\n    alias: ['image', 'pic', 'picture'],\r\n    icon: icons.image,\r\n    title: title.image,\r\n    onClick(this: Quill, range: Range | null, _: any) {\r\n      if (!range) return;\r\n      const src = prompt('Enter image');\r\n      if (!src) return;\r\n      this.insertEmbed(range.index, 'image', src, Quill.sources.USER);\r\n    },\r\n  },\r\n  {\r\n    type: 'item' as const,\r\n    name: 'vd',\r\n    alias: ['video'],\r\n    icon: icons.video,\r\n    title: title.video,\r\n    onClick(this: Quill, range: Range | null, _: any) {\r\n      if (!range) return;\r\n      const src = prompt('Enter video');\r\n      if (!src) return;\r\n      this.insertEmbed(range.index, 'video', src, Quill.sources.USER);\r\n    },\r\n  },\r\n  {\r\n    type: 'item' as const,\r\n    name: 'fm',\r\n    alias: ['formula'],\r\n    icon: icons.formula,\r\n    title: title.formula,\r\n    onClick(this: Quill, range: Range | null, _: any) {\r\n      if (!range) return;\r\n      const text = prompt('Enter formula');\r\n      if (!text) return;\r\n      this.insertEmbed(range.index, 'formula', text, Quill.sources.USER);\r\n    },\r\n  },\r\n  {\r\n    type: 'group' as const,\r\n    name: 'list',\r\n    alias: [],\r\n    hideSearch: true,\r\n    icon: icons.list.bullet,\r\n    title: title.list,\r\n    children: [\r\n      {\r\n        type: 'item' as const,\r\n        name: 'bl',\r\n        alias: ['list', 'bullet'],\r\n        icon: icons.list.bullet,\r\n        title: title.listBullet,\r\n        onClick(this: Quill, range: Range | null, _: any) {\r\n          if (!range) return;\r\n          this.formatLine(range.index, 0, 'list', 'bullet', Quill.sources.USER);\r\n        },\r\n      },\r\n      {\r\n        type: 'item' as const,\r\n        name: 'od',\r\n        alias: ['list', 'ordered'],\r\n        icon: icons.list.ordered,\r\n        title: title.listOrdered,\r\n        onClick(this: Quill, range: Range | null, _: any) {\r\n          if (!range) return;\r\n          this.formatLine(range.index, 0, 'list', 'ordered', Quill.sources.USER);\r\n        },\r\n      },\r\n      {\r\n        type: 'item' as const,\r\n        name: 'ck',\r\n        alias: ['list', 'check'],\r\n        icon: icons.list.check,\r\n        title: title.listCheck,\r\n        onClick(this: Quill, range: Range | null, _: any) {\r\n          if (!range) return;\r\n          this.formatLine(range.index, 0, 'list', 'unchecked', Quill.sources.USER);\r\n        },\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\nconst generateShortKey = (formatWithKeyMap: Record<string, Record<string, any>>) => {\r\n  const formatAndValue = Object.keys(formatWithKeyMap);\r\n  const bindings: Record<string, any> = {};\r\n  for (const item of formatAndValue) {\r\n    const [format, value] = item.split(' ');\r\n    const isSwitch = isUndefined(value);\r\n    bindings[item] = {\r\n      handler(this: { quill: Quill }, range: Range, context: Context) {\r\n        this.quill.format(format, isSwitch ? !context.format[format] : value, Quill.sources.USER);\r\n      },\r\n      ...formatWithKeyMap[item],\r\n    };\r\n  }\r\n  return bindings;\r\n};\r\nexport const defaultShortKey = {\r\n  clean: {\r\n    key: '/',\r\n    shortKey: true,\r\n    handler(this: { quill: Quill }, range: Range) {\r\n      this.quill.removeFormat(range.index, range.length, Quill.sources.USER);\r\n    },\r\n  },\r\n  ...generateShortKey({\r\n    'strike': {\r\n      key: 'd',\r\n      shortKey: true,\r\n    },\r\n    'align ': {\r\n      key: 'l',\r\n      altKey: true,\r\n    },\r\n    'align center': {\r\n      key: 'c',\r\n      altKey: true,\r\n    },\r\n    'align right': {\r\n      key: 'r',\r\n      altKey: true,\r\n    },\r\n    'align justify': {\r\n      key: 'j',\r\n      altKey: true,\r\n    },\r\n    'indent +1': {\r\n      key: ']',\r\n      shortKey: true,\r\n    },\r\n    'indent -1': {\r\n      key: '[',\r\n      shortKey: true,\r\n    },\r\n    'script sub': {\r\n      key: ';',\r\n      shortKey: true,\r\n    },\r\n    'script super': {\r\n      key: '\\'',\r\n      shortKey: true,\r\n    },\r\n    'code': {\r\n      key: 'e',\r\n      shortKey: true,\r\n    },\r\n    'direction rtl': {\r\n      key: 'r',\r\n      shortKey: true,\r\n    },\r\n    'direction ': {\r\n      key: 'l',\r\n      shortKey: true,\r\n    },\r\n  }),\r\n};\r\n\r\nexport function generateTableUpShortKeyMenu(createSelectBox: (ops: { row: number; col: number; customBtn: boolean }) => HTMLElement): {\r\n  tableUpKeyboardControl: QuillShortcutKeyOptions['menuKeyboardControls'];\r\n  tableUpConfig: MenuItemsGroup;\r\n} {\r\n  const maxSelectRow = 8;\r\n  const maxSelectCol = 8;\r\n  const selectBox = createSelectBox({\r\n    row: maxSelectRow,\r\n    col: maxSelectCol,\r\n    customBtn: false,\r\n  });\r\n  const updateSelectActiveItems = () => {\r\n    const { row, col } = selectBox.dataset;\r\n    for (const item of Array.from(selectBox.querySelectorAll('.active'))) {\r\n      item.classList.remove('active');\r\n    }\r\n    if (!row || !col) return;\r\n    const childs = Array.from(selectBox.querySelectorAll('.table-up-select-box__item')) as HTMLElement[];\r\n    for (let i = 0; i < childs.length; i++) {\r\n      const { row: childRow, col: childCol } = childs[i].dataset;\r\n      if (childRow! > row && childCol! > col) {\r\n        return;\r\n      }\r\n      if (childRow! <= row && childCol! <= col) {\r\n        childs[i].classList.add('active');\r\n      }\r\n      else {\r\n        childs[i].classList.remove('active');\r\n      }\r\n    }\r\n  };\r\n\r\n  return {\r\n    tableUpKeyboardControl: (event: KeyboardEvent, { currentMenu }: { currentMenu: HTMLElement; selectedIndex: number }) => {\r\n      if (!currentMenu.contains(selectBox)) return false;\r\n      let row = Number(selectBox.dataset.row);\r\n      let col = Number(selectBox.dataset.col);\r\n      switch (event.key) {\r\n        case 'ArrowUp': {\r\n          row -= 1;\r\n          break;\r\n        }\r\n        case 'ArrowDown': {\r\n          row += 1;\r\n          break;\r\n        }\r\n        case 'ArrowRight': {\r\n          col += 1;\r\n          break;\r\n        }\r\n        case 'ArrowLeft': {\r\n          col -= 1;\r\n          break;\r\n        }\r\n        default: {\r\n          return false;\r\n        }\r\n      }\r\n      if (row <= 0 || col <= 0) return false;\r\n      row = Math.min(row, 8);\r\n      col = Math.min(col, 8);\r\n      selectBox.dataset.row = String(row);\r\n      selectBox.dataset.col = String(col);\r\n      updateSelectActiveItems();\r\n      event.preventDefault();\r\n      return true;\r\n    },\r\n    tableUpConfig: {\r\n      type: 'group',\r\n      name: 'table',\r\n      alias: [],\r\n      title: '表格',\r\n      icon: (Quill.import('ui/icons') as Record<string, string>).table,\r\n      onOpenSub(data: MenuEventData) {\r\n        const subMenu = data.item.querySelector('.qsf-menu') as HTMLElement;\r\n        if (subMenu) {\r\n          subMenu.style.width = 'auto';\r\n        }\r\n        selectBox.dataset.row = '1';\r\n        selectBox.dataset.col = '1';\r\n        updateSelectActiveItems();\r\n      },\r\n      children: [\r\n        {\r\n          type: 'item',\r\n          name: 'table',\r\n          alias: [],\r\n          classes: ['no-selected-style'],\r\n          hideSearch: true,\r\n          content() {\r\n            return selectBox;\r\n          },\r\n          onClick(this: Quill) {\r\n            const { row, col } = selectBox.dataset;\r\n            if (!row || !col) return;\r\n            const tableUp = this.getModule('table-up') as any;\r\n            tableUp.insertTable(Number(row), Number(col));\r\n          },\r\n        },\r\n      ],\r\n    },\r\n  };\r\n}\r\n","export function throttle(func: (...args: any[]) => any, wait: number) {\r\n  let timeout: ReturnType<typeof setTimeout> | null = null;\r\n  let lastArgs: any[] = [];\r\n  let lastThis: any = null;\r\n  let lastCallTime = 0;\r\n\r\n  return function (this: any, ...args: any[]) {\r\n    const now = Date.now();\r\n    const remainingTime = wait - (now - lastCallTime);\r\n\r\n    lastArgs = args;\r\n    lastThis = this;\r\n\r\n    if (remainingTime <= 0 || remainingTime > wait) {\r\n      if (timeout) {\r\n        clearTimeout(timeout);\r\n        timeout = null;\r\n      }\r\n      lastCallTime = now;\r\n      func.apply(lastThis, lastArgs);\r\n    }\r\n    else if (!timeout) {\r\n      timeout = setTimeout(() => {\r\n        lastCallTime = Date.now();\r\n        timeout = null;\r\n        func.apply(lastThis, lastArgs);\r\n      }, remainingTime);\r\n    }\r\n  };\r\n}\r\n","import type { SearchIndexInput } from './types';\r\n\r\nfunction matchScore(input: string, target: string): number {\r\n  const inputLower = input.toLowerCase();\r\n  const targetLower = target.toLowerCase();\r\n\r\n  if (inputLower === targetLower) {\r\n    return 2; // 完全匹配\r\n  }\r\n  else if (targetLower.includes(inputLower)) {\r\n    return 1; // 部分匹配\r\n  }\r\n  else {\r\n    return 0; // 不匹配\r\n  }\r\n}\r\n\r\nexport function searchAndSort<T extends SearchIndexInput[]>(items: T, input: string): T {\r\n  const threshold = 0.5; // 匹配分数阈值\r\n\r\n  const scoredItems = items.map((item) => {\r\n    let score = matchScore(input, item.name);\r\n\r\n    if (item.alias) {\r\n      for (const alias of item.alias) {\r\n        score = Math.max(score, matchScore(input, alias));\r\n      }\r\n    }\r\n\r\n    return { item, score };\r\n  });\r\n\r\n  const filteredItems = scoredItems.filter(({ score }) => score >= threshold);\r\n  filteredItems.sort((a, b) => b.score - a.score);\r\n  return filteredItems.map(({ item }) => item) as T;\r\n}\r\n","import type { Delta, Range } from 'quill';\r\nimport type { BlockEmbed as TypeBlockEmbed } from 'quill/blots/block';\r\nimport type TypeBlock from 'quill/blots/block';\r\nimport type { Menu, MenuItemData, MenuItems, MenuItemsGroup, QuillShortcutKeyInputOptions, QuillShortcutKeyOptions } from './utils';\r\nimport Quill from 'quill';\r\nimport { createBEM, createMenu, isString, searchAndSort, throttle } from './utils';\r\n\r\nconst Parchment = Quill.import('parchment');\r\n\r\nexport class QuillShortcutKey {\r\n  bem = createBEM('qsf', 'menu');\r\n  options: QuillShortcutKeyOptions;\r\n  menuSorter: (searchText: string) => Menu;\r\n  currentMenu: Menu;\r\n  menuContainer?: HTMLElement;\r\n  menuKeyboardControlsCleanup?: () => void;\r\n  currentRange: Range = { index: 0, length: 0 };\r\n  placeholderBem = createBEM('qsf', 'placeholder');\r\n  placeholderTip: HTMLElement;\r\n\r\n  constructor(public quill: Quill, options: Partial<QuillShortcutKeyInputOptions>) {\r\n    this.options = this.resolveOptions(options);\r\n    this.currentMenu = this.options.menuItems;\r\n    this.menuSorter = searchAndSort.bind(this, this.getAllMenuItems()) as (searchText: string) => Menu;\r\n\r\n    this.placeholderTip = this.initPlaceholder();\r\n    this.placeholderUpdate();\r\n    this.quill.on(Quill.events.COMPOSITION_START, () => {\r\n      this.placeholderHide();\r\n    });\r\n    this.quill.on(Quill.events.COMPOSITION_END, () => {\r\n      this.placeholderUpdate();\r\n    });\r\n    this.quill.on(Quill.events.EDITOR_CHANGE, (type: string, current: Delta | Range) => {\r\n      this.placeholderUpdate();\r\n\r\n      if (type === Quill.events.SELECTION_CHANGE) {\r\n        const range = current as Range;\r\n        if (range && range.length === 0) {\r\n          const [line, offset] = this.quill.getLine(range.index);\r\n          if (line) {\r\n            const lineStartIndex = range.index - offset;\r\n            const lineEndIndex = lineStartIndex + line.length();\r\n            const text = this.quill.getText(lineStartIndex, lineEndIndex);\r\n            const formats = this.quill.getFormat(range.index, range.length);\r\n            const hasBlock = this.hasBlockFormat(formats);\r\n            if (text.startsWith('/') && !hasBlock) {\r\n              const matchString = text.match(/^\\/(.+)/);\r\n              if (matchString) {\r\n                const matchItems = this.menuSorter(matchString[1]);\r\n                this.currentMenu = matchItems;\r\n              }\r\n              else {\r\n                this.currentMenu = this.options.menuItems;\r\n              }\r\n              this.updateMenuList(line, formats);\r\n              return;\r\n            }\r\n          }\r\n        }\r\n        this.destroyMenuList();\r\n      }\r\n      else if (type === Quill.events.TEXT_CHANGE) {\r\n        const delta = current as Delta;\r\n        for (const op of delta.ops) {\r\n          if (op.insert) {\r\n            if (op.insert === '/') {\r\n              this.generateMenuList();\r\n            }\r\n            else {\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    });\r\n    this.quill.root.addEventListener('scroll', () => {\r\n      this.placeholderUpdate();\r\n    });\r\n  }\r\n\r\n  resolveOptions(options: Partial<QuillShortcutKeyInputOptions>): QuillShortcutKeyOptions {\r\n    return Object.assign({\r\n      placeholder: 'Input / recall menu',\r\n      menuItems: [] as any[],\r\n      menuKeyboardControls: () => false,\r\n    }, options);\r\n  }\r\n\r\n  getAllMenuItems() {\r\n    const list: Menu = [];\r\n    for (const item of this.options.menuItems) {\r\n      if (!item.hideSearch) {\r\n        list.push(item);\r\n      }\r\n      if (item.type === 'group') {\r\n        list.push(...item.children.filter(i => !i.hideSearch));\r\n      }\r\n    }\r\n    return list;\r\n  }\r\n\r\n  hasBlockFormat(formats: Record<string, any>): boolean {\r\n    return Object.keys(formats).some(format => this.quill.scroll.registry.query(format, Parchment.Scope.BLOCK_BLOT));\r\n  }\r\n\r\n  initPlaceholder() {\r\n    const wrapper = this.quill.addContainer(this.placeholderBem.be('wrapper'));\r\n    const tip = this.quill.addContainer(this.placeholderBem.b());\r\n    tip.dataset.placeholder = this.options.placeholder;\r\n    wrapper.appendChild(tip);\r\n    return tip;\r\n  }\r\n\r\n  placeholderUpdate() {\r\n    const range = this.quill.getSelection();\r\n    if (range) {\r\n      this.currentRange = range;\r\n    }\r\n    // if use attribute mark on current focus line. will have selection wrong behavior when use keyboard `Shift` and `ArrowUp` select editor\r\n    if (this.currentRange.length === 0) {\r\n      const [line] = this.quill.getLine(this.currentRange.index);\r\n\r\n      if (line && line.length() <= 1) {\r\n        const delta = this.quill.getContents(this.currentRange.index, line.length() || 0).ops[0];\r\n        const hasBlockFormat = this.hasBlockFormat(delta.attributes || {});\r\n        let hasBlockEmbed = false;\r\n        if (!isString(delta.insert)) {\r\n          hasBlockEmbed = this.hasBlockFormat(delta.insert || {});\r\n        }\r\n        if (!hasBlockFormat && !hasBlockEmbed) {\r\n          const bound = this.quill.getBounds(this.currentRange);\r\n          if (bound) {\r\n            this.placeholderTip.classList.remove(this.placeholderBem.is('hidden'));\r\n            this.placeholderTip.classList.remove(this.placeholderBem.is('right'));\r\n            const style = {\r\n              left: `${bound.left}px`,\r\n              top: `${bound.top}px`,\r\n            };\r\n            if (delta.attributes && delta.attributes.align === 'right') {\r\n              this.placeholderTip.classList.add(this.placeholderBem.is('right'));\r\n              // minus for placeholder position looks more natural\r\n              style.left = `${bound.right - 1}px`;\r\n            }\r\n            Object.assign(this.placeholderTip.style, style);\r\n          }\r\n          return;\r\n        }\r\n      }\r\n    }\r\n    this.placeholderHide();\r\n  }\r\n\r\n  placeholderHide() {\r\n    this.placeholderTip.classList.add(this.placeholderBem.is('hidden'));\r\n  }\r\n\r\n  generateMenuItem(relativeLine: TypeBlock | TypeBlockEmbed, item: MenuItems | MenuItemsGroup): MenuItemData {\r\n    return {\r\n      ...item,\r\n      type: 'item' as const,\r\n      children: ((item as MenuItemsGroup).children || []).map(i => this.generateMenuItem(relativeLine, i)),\r\n      content: () => {\r\n        if (item.content) {\r\n          return item.content();\r\n        }\r\n        else {\r\n          const itemContent = document.createElement('div');\r\n          itemContent.classList.add(this.bem.be('item-container'));\r\n\r\n          if (item.icon) {\r\n            const iconWrap = document.createElement('div');\r\n            iconWrap.classList.add(this.bem.be('item-icon'));\r\n            const icon = document.createElement('div');\r\n            icon.classList.add(this.bem.be('icon'));\r\n            icon.innerHTML = item.icon;\r\n            iconWrap.appendChild(icon);\r\n            itemContent.appendChild(iconWrap);\r\n          }\r\n\r\n          const itemContentMain = document.createElement('div');\r\n          itemContentMain.classList.add(this.bem.be('item-content'));\r\n\r\n          const itemContentTitle = document.createElement('div');\r\n          itemContentTitle.classList.add(this.bem.be('item-title'));\r\n          const titleText = document.createElement('span');\r\n          titleText.textContent = item.title!;\r\n          itemContentTitle.appendChild(titleText);\r\n\r\n          if (item.type === 'item') {\r\n            const itemContentHint = document.createElement('span');\r\n            itemContentHint.classList.add(this.bem.be('item-hint'));\r\n            itemContentHint.textContent = `/${item.name}`;\r\n            itemContentTitle.appendChild(itemContentHint);\r\n          }\r\n          itemContentMain.appendChild(itemContentTitle);\r\n\r\n          if (item.descriptions) {\r\n            const itemContentDescriptions = document.createElement('div');\r\n            itemContentDescriptions.classList.add(this.bem.be('item-descriptions'));\r\n            itemContentDescriptions.textContent = item.descriptions;\r\n            itemContentMain.appendChild(itemContentDescriptions);\r\n          }\r\n\r\n          itemContent.appendChild(itemContentMain);\r\n          return itemContent;\r\n        }\r\n      },\r\n      onClose: (data) => {\r\n        if (item.onCloseSub) {\r\n          item.onCloseSub.call(this.quill, data);\r\n        }\r\n      },\r\n      onOpen: (data) => {\r\n        if (item.onOpenSub) {\r\n          item.onOpenSub.call(this.quill, data);\r\n        }\r\n      },\r\n      onClick: (data) => {\r\n        if (item.type === 'item') {\r\n          relativeLine.domNode.innerHTML = '';\r\n          this.destroyMenuList();\r\n        }\r\n        if (item.onClick) {\r\n          const range = this.quill.getSelection();\r\n          item.onClick.call(this.quill, range, data);\r\n        }\r\n      },\r\n    };\r\n  }\r\n\r\n  generateMenuList() {\r\n    if (!this.menuContainer) {\r\n      this.menuContainer = document.createElement('div');\r\n      this.menuContainer.classList.add(this.bem.be('container'));\r\n      this.quill.root.addEventListener('click', this.destroyMenuList);\r\n      this.quill.container.appendChild(this.menuContainer);\r\n    }\r\n  }\r\n\r\n  updateMenuList(relativeLine: TypeBlock | TypeBlockEmbed, formats: Record<string, any>) {\r\n    if (!this.menuContainer) return;\r\n\r\n    this.menuContainer.innerHTML = '';\r\n    const content = createMenu(this.currentMenu.map(item => this.generateMenuItem(relativeLine, item)));\r\n    if (this.menuKeyboardControlsCleanup) {\r\n      this.menuKeyboardControlsCleanup();\r\n    }\r\n    this.menuKeyboardControlsCleanup = this.setupMenuKeyboardControls({\r\n      wrapper: content,\r\n      target: this.quill.root,\r\n      menuControl: this.options.menuKeyboardControls,\r\n    });\r\n    const rootRect = this.quill.root.getBoundingClientRect();\r\n    const lineRect = relativeLine.domNode.getBoundingClientRect();\r\n    const left = lineRect.left - rootRect.left + (formats.align === 'right' ? lineRect.width : 0);\r\n    const top = lineRect.bottom - rootRect.top;\r\n    Object.assign(this.menuContainer.style, {\r\n      left: `${left}px`,\r\n      top: `${top}px`,\r\n    });\r\n    this.menuContainer.appendChild(content);\r\n    // limit in viewport\r\n    requestAnimationFrame(() => {\r\n      if (!this.menuContainer) return;\r\n      const rect = this.menuContainer.getBoundingClientRect();\r\n      if (window.innerWidth < rect.right) {\r\n        this.menuContainer.style.left = `${left - rect.width}px`;\r\n      }\r\n      if (window.innerHeight < rect.bottom) {\r\n        this.menuContainer.style.top = `${top - lineRect.height - rect.height}px`;\r\n      }\r\n    });\r\n  }\r\n\r\n  destroyMenuList = () => {\r\n    this.quill.root.removeEventListener('click', this.destroyMenuList);\r\n    if (this.menuKeyboardControlsCleanup) this.menuKeyboardControlsCleanup();\r\n    if (!this.menuContainer) return;\r\n    this.menuContainer.remove();\r\n    this.menuContainer = undefined;\r\n  };\r\n\r\n  setupMenuKeyboardControls({ wrapper, target, menuControl }: {\r\n    wrapper: HTMLElement;\r\n    target: HTMLElement;\r\n    menuControl: (event: KeyboardEvent, data: { currentMenu: HTMLElement; selectedIndex: number }) => boolean;\r\n  }) {\r\n    let currentMenu = wrapper;\r\n    let parentMenu: HTMLElement | null = null;\r\n    let selectedIndex = -1;\r\n\r\n    const setSelected = (index: number) => {\r\n      const items = Array.from(currentMenu.querySelectorAll(`.${this.bem.be('item')}`)) as HTMLElement[];\r\n      for (const [i, item] of items.entries()) {\r\n        if (i === index) {\r\n          item.classList.add(this.bem.is('selected'));\r\n\r\n          const containerRect = currentMenu.getBoundingClientRect();\r\n          const itemRect = item.getBoundingClientRect();\r\n\r\n          const isItemBelow = itemRect.bottom > containerRect.bottom;\r\n          const isItemAbove = itemRect.top < containerRect.top;\r\n          if (isItemBelow) {\r\n            currentMenu.scrollTop = item.offsetTop - currentMenu.clientHeight + itemRect.height;\r\n          }\r\n          else if (isItemAbove) {\r\n            currentMenu.scrollTop = item.offsetTop;\r\n          }\r\n        }\r\n        else {\r\n          item.classList.remove(this.bem.is('selected'));\r\n        }\r\n      }\r\n      selectedIndex = index;\r\n    };\r\n\r\n    const handleItemSelect = throttle((event: KeyboardEvent) => {\r\n      const items = currentMenu.querySelectorAll(`:scope > .${this.bem.be('item')}`);\r\n      if ((items.length === 0 && event.key === 'Enter') || event.key === 'Escape') {\r\n        event.preventDefault();\r\n        this.destroyMenuList();\r\n      }\r\n      if (items.length === 0) {\r\n        return;\r\n      }\r\n\r\n      const prevent = menuControl(event, { currentMenu, selectedIndex });\r\n      if (prevent) return;\r\n\r\n      switch (event.key) {\r\n        case 'ArrowUp': {\r\n          event.preventDefault();\r\n          if (selectedIndex === -1) selectedIndex = 0;\r\n          setSelected((selectedIndex - 1 + items.length) % items.length);\r\n          break;\r\n        }\r\n        case 'ArrowDown': {\r\n          event.preventDefault();\r\n          setSelected((selectedIndex + 1) % items.length);\r\n          break;\r\n        }\r\n        case 'ArrowRight': {\r\n          event.preventDefault();\r\n          const selectedItem = items[selectedIndex] as HTMLElement;\r\n          if (!selectedItem) return;\r\n          const hasSubMenu = selectedItem.dataset.hasChildren === 'true';\r\n          if (hasSubMenu) {\r\n            selectedItem.click();\r\n            const subMenu = selectedItem.querySelector(`.${this.bem.b()}`) as HTMLElement;\r\n            if (subMenu) {\r\n              parentMenu = currentMenu;\r\n              currentMenu = subMenu;\r\n              setSelected(0);\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case 'ArrowLeft': {\r\n          event.preventDefault();\r\n          if (parentMenu) {\r\n            const parentIndex = Number.parseInt(currentMenu.dataset.parent || '0', 10);\r\n            currentMenu = parentMenu;\r\n            parentMenu = null;\r\n            selectedIndex = parentIndex;\r\n            setSelected(selectedIndex);\r\n            const selectedItem = Array.from(currentMenu.querySelectorAll(`.${this.bem.be('item')}`))[selectedIndex] as HTMLElement;\r\n            if (!selectedItem) return;\r\n            selectedItem.dispatchEvent(new MouseEvent('mouseleave'));\r\n          }\r\n          break;\r\n        }\r\n        case 'Enter': {\r\n          event.preventDefault();\r\n          // default select first\r\n          const selectedItem = items[Math.max(0, selectedIndex)] as HTMLElement;\r\n          if (selectedItem) {\r\n            selectedItem.click();\r\n            if (selectedItem.dataset.hasChildren === 'true') {\r\n              const subMenu = selectedItem.querySelector(`.${this.bem.b()}`) as HTMLElement;\r\n              if (subMenu) {\r\n                parentMenu = currentMenu;\r\n                currentMenu = subMenu;\r\n                setSelected(0);\r\n              }\r\n            }\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }, 100);\r\n    const handleKeyDown = (event: KeyboardEvent) => {\r\n      const keys = new Set([\r\n        'ArrowUp',\r\n        'ArrowDown',\r\n        'ArrowRight',\r\n        'ArrowLeft',\r\n        'Enter',\r\n        'Escape',\r\n      ]);\r\n      if (keys.has(event.key)) {\r\n        event.preventDefault();\r\n      }\r\n      handleItemSelect(event);\r\n    };\r\n\r\n    target.addEventListener('keydown', handleKeyDown, true);\r\n    return () => {\r\n      target.removeEventListener('keydown', handleKeyDown, true);\r\n    };\r\n  }\r\n}\r\n\r\nexport { defaultMenuItems, defaultShortKey, generateTableUpShortKeyMenu, searchAndSort } from './utils';\r\nexport default QuillShortcutKey;\r\nexport * from './utils/types';\r\n"],"mappings":"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"}